- name: Deploy to GitHub Pages
      env:
        GIT_USERNAME: liudungen
        GIT_EMAIL: 798695922@qq.com
        # 关键：把 Secret 存到环境变量 TOKEN 里（Shell 能识别）
        TOKEN: ${{ secrets.HEXO_DEPLOY_TOKEN }}
      run: |
        if [ ! -d "public" ]; then
          echo "ERROR: public directory not found!"
          exit 1
        fi
        
        # 先判断环境变量 TOKEN 是否为空（Shell 能正确识别）
        if [ -z "$TOKEN" ]; then
          echo "ERROR: HEXO_DEPLOY_TOKEN is not set!"
          exit 1
        fi
        
        cd public
        git init
        git config user.name "$GIT_USERNAME"
        git config user.email "$GIT_EMAIL"
        git branch -m main
        git add -A
        git commit -m "Deploy: $(date +'%Y-%m-%d %H:%M:%S')"
        
        # 用环境变量 TOKEN 推送
        git push -f "https://x-access-token:$TOKEN@github.com/liudungen/liudungen.github.io.git" main