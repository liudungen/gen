name: Deploy Hexo - 简化测试版
on:
  push:
    branches: [ main ]
jobs:
  test-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      - name: 最小化测试
        run: |
          echo "=== 开始测试 ==="
          
          # 创建最简单的 Hexo 项目
          mkdir test-hexo
          cd test-hexo
          
          # 初始化
          npx hexo-cli@4.3.2 init . --no-clone 2>&1 | tail -20
          
          # 安装
          npm install hexo@8.1.1 2>&1 | tail -20
          
          # 创建文章
          cat > source/_posts/test.md << 'EOF'
---
title: 测试文章
date: 2024-01-01 10:00:00
---
测试内容。
EOF
          
          # 生成
          npx hexo generate 2>&1 | tail -30
          
          if [ -d "public" ]; then
            echo "✅ 测试成功"
            ls -la public/
          else
            echo "❌ 测试失败"
            exit 1
          fi
